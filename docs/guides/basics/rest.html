

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>REST APIs &mdash; feathers docs v2019.06.21 文档</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="数据库" href="databases.html" />
    <link rel="prev" title="钩子" href="hooks.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../contents.html" class="icon icon-home"> feathers docs
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Feathers[fɛðɚ]</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">指南</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../readme.html">指南</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Feathers 基础功能</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="readme.html">Feathers 基础知识</a></li>
<li class="toctree-l3"><a class="reference internal" href="setup.html">设置</a></li>
<li class="toctree-l3"><a class="reference internal" href="starting.html">我们的第一个Feathers应用程序</a></li>
<li class="toctree-l3"><a class="reference internal" href="services.html">服务</a></li>
<li class="toctree-l3"><a class="reference internal" href="hooks.html">钩子</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">REST APIs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rest-and-services">REST和服务</a></li>
<li class="toctree-l4"><a class="reference internal" href="#express-integration">快速整合</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-messages-rest-api">消息REST API</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-the-api">使用API</a></li>
<li class="toctree-l4"><a class="reference internal" href="#whats-next">下一步是什么？</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="databases.html">数据库</a></li>
<li class="toctree-l3"><a class="reference internal" href="real-time.html">实时API</a></li>
<li class="toctree-l3"><a class="reference internal" href="clients.html">客户端使用</a></li>
<li class="toctree-l3"><a class="reference internal" href="generator.html">Feathers生成器(CLI)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../chat/index.html">创建聊天应用程序</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auth/index.html">身份验证指南和食谱</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/index.html">高级指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frameworks/readme.html">与前端框架集成</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migrating.html">Feathers v3(秃鹰)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../SECURITY.html">Feathers 安全</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Ecosystem/index.html">令人敬畏的Feathers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help/readme.html">求助！</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/readme.html">常问问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/readme.html">特约</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">有许可证</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../github/index.html">github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Summary.html">摘要</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../contents.html">feathers docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">指南</a> &raquo;</li>
        
          <li><a href="index.html">Feathers 基础功能</a> &raquo;</li>
        
      <li>REST APIs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/guides/basics/rest.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rest-apis">
<h1>REST APIs<a class="headerlink" href="#rest-apis" title="永久链接至标题">¶</a></h1>
<p>在前面的章节中, 我们了解了Feathers <a class="reference internal" href="hooks.html"><span class="doc">钩子</span></a> 并创建了一个在NodeJS和浏览器中工作的消息服务.我们看到了Feathers如何自动发送事件, 但到目前为止我们并没有真正创建其他人可以使用的Web API.</p>
<p>这就是Feathers传输的目的.传输是一个插件, 可以将Feathers应用程序转换为服务器, 通过不同的协议公开我们的服务, 供其他客户端使用.由于传输涉及运行服务器, 因此它无法在浏览器中运行, 但我们稍后会了解到, 在浏览器Feathers应用程序中有连接到Feathers服务器的补充插件.</p>
<p>目前, Feathers正式拥有三种传输工具:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../api/express.html"><span class="doc">Express</span></a> 用于通过JSON REST API公开服务</p></li>
<li><p><a class="reference internal" href="../../api/socketio.html"><span class="doc">Socket.io</span></a> 通过websockets连接服务并接收实时服务事件</p></li>
<li><p><a class="reference internal" href="../../api/primus.html"><span class="doc">Primus</span></a> Socket.io的替代方案, 支持几个支持实时事件的websocket协议</p></li>
</ul>
<p>在本章中, 我们将介绍HTTP REST传输和Feathers Express框架集成.</p>
<div class="section" id="rest-and-services">
<h2>REST和服务<a class="headerlink" href="#rest-and-services" title="永久链接至标题">¶</a></h2>
<p>Feathers的目标之一是使构建 <a class="reference external" href="https://en.wikipedia.org/wiki/Representational_state_transfer">REST API</a> 更容易, 因为它是迄今为止最常用的Web API协议. 例如, 我们想要发出像 <code class="docutils literal notranslate"><span class="pre">GET/messages/1</span></code> 这样的请求, 并获得一个JSON响应, 如 <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;id&quot;:</span> <span class="pre">1,</span> <span class="pre">&quot;text&quot;:</span> <span class="pre">&quot;The</span> <span class="pre">first</span> <span class="pre">message&quot;</span> <span class="pre">}</span></code>. 您可能已经注意到Feathers服务方法和HTTP方法如 <code class="docutils literal notranslate"><span class="pre">GET</span></code>, <code class="docutils literal notranslate"><span class="pre">POST</span></code>, <code class="docutils literal notranslate"><span class="pre">PATCH</span></code> 和 <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> 相互补充:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 39%" />
<col style="width: 31%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>服务方式</p></th>
<th class="head"><p>HTTP方法</p></th>
<th class="head"><p>Path</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>.find()</p></td>
<td><p>GET</p></td>
<td><p>/messages</p></td>
</tr>
<tr class="row-odd"><td><p>.get()</p></td>
<td><p>GET</p></td>
<td><p>/messages/1</p></td>
</tr>
<tr class="row-even"><td><p>.create()</p></td>
<td><p>POST</p></td>
<td><p>/messages</p></td>
</tr>
<tr class="row-odd"><td><p>.update()</p></td>
<td><p>PUT</p></td>
<td><p>/messages/1</p></td>
</tr>
<tr class="row-even"><td><p>.patch()</p></td>
<td><p>PATCH</p></td>
<td><p>/messages/1</p></td>
</tr>
<tr class="row-odd"><td><p>.remove()</p></td>
<td><p>DELETE</p></td>
<td><p>/messages/1</p></td>
</tr>
</tbody>
</table>
<p>Feathers REST传输的基本功能是自动将现有服务方法映射到这些端点.</p>
</div>
<div class="section" id="express-integration">
<h2>快速整合<a class="headerlink" href="#express-integration" title="永久链接至标题">¶</a></h2>
<p><a class="reference external" href="http://expressjs.com/">Express</a> 可能是用于创建Web应用程序和API的最流行的Node框架. <a class="reference internal" href="../../api/express.html"><span class="doc">Express</span></a> 允许我们将Feathers应用程序转换为一个既是Feathers应用程序又是完全兼容的Express应用程序的应用程序.这意味着您可以使用诸如服务之类的Feathers功能以及任何现有的Express中间件.如前所述, Express框架集成仅适用于服务器.</p>
<p>要添加我们安装的集成 <code class="docutils literal notranslate"><span class="pre">&#64;feathersjs/express</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>npm install @feathersjs/express --save
</pre></div>
</div>
<p>然后我们可以初始化一个Feathers和Express应用程序, 它将服务作为REST API在端口 <code class="docutils literal notranslate"><span class="pre">3030</span></code> 上公开:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">feathers</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@feathersjs/feathers&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@feathersjs/express&#39;</span><span class="p">);</span>

<span class="c1">// This creates an app that is both, an Express and Feathers app</span>
<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">(</span><span class="nx">feathers</span><span class="p">());</span>

<span class="c1">// Turn on JSON body parsing for REST services</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
<span class="c1">// Turn on URL-encoded body parsing for REST services</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span> <span class="nx">extended</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}));</span>
<span class="c1">// Set up REST transport using Express</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">configure</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">rest</span><span class="p">());</span>

<span class="c1">// Set up an error handler that gives us nicer errors</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">errorHandler</span><span class="p">());</span>

<span class="c1">// Start the server on port 3030</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3030</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">express.json</span></code>, <code class="docutils literal notranslate"><span class="pre">express.urlencoded</span></code> 和 <code class="docutils literal notranslate"><span class="pre">express.errorHandler</span></code> 是正常的Express中间件.我们仍然可以使用 <code class="docutils literal notranslate"><span class="pre">app.use</span></code> 来注册Feathers服务.</p>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>您可以在 <a class="reference internal" href="../../api/express.html"><span class="doc">Express</span></a> 中找到有关Express框架集成的更多信息.</p>
</div>
</div>
<div class="section" id="a-messages-rest-api">
<h2>消息REST API<a class="headerlink" href="#a-messages-rest-api" title="永久链接至标题">¶</a></h2>
<p>上面的代码实际上是我们将消息服务转换为REST API所需的全部内容.以下是我们的 <code class="docutils literal notranslate"><span class="pre">app.js</span></code> 的完整代码, 它通过REST API从 <a class="reference internal" href="services.html"><span class="doc">服务</span></a> 公开服务:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">feathers</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@feathersjs/feathers&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@feathersjs/express&#39;</span><span class="p">);</span>

<span class="kr">class</span> <span class="nx">Messages</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">messages</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">currentId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">async</span> <span class="nx">find</span><span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Return the list of all messages</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">messages</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">async</span> <span class="nx">get</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Find the message by id</span>
    <span class="kr">const</span> <span class="nx">message</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">message</span> <span class="p">=&gt;</span> <span class="nx">message</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="mi">10</span><span class="p">));</span>

    <span class="c1">// Throw an error if it wasn&#39;t found</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="sb">`Message with id </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb"> not found`</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Otherwise return the message</span>
    <span class="k">return</span> <span class="nx">message</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">async</span> <span class="nx">create</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Create a new object with the original data and an id</span>
    <span class="c1">// taken from the incrementing `currentId` counter</span>
    <span class="kr">const</span> <span class="nx">message</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({</span>
      <span class="nx">id</span><span class="o">:</span> <span class="o">++</span><span class="k">this</span><span class="p">.</span><span class="nx">currentId</span>
    <span class="p">},</span> <span class="nx">data</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">message</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">async</span> <span class="nx">patch</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Get the existing message. Will throw an error if not found</span>
    <span class="kr">const</span> <span class="nx">message</span> <span class="o">=</span> <span class="nx">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>

    <span class="c1">// Merge the existing message with the new data</span>
    <span class="c1">// and return the result</span>
    <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">async</span> <span class="nx">remove</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Get the message by id (will throw an error if not found)</span>
    <span class="kr">const</span> <span class="nx">message</span> <span class="o">=</span> <span class="nx">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="c1">// Find the index of the message in our message array</span>
    <span class="kr">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>

    <span class="c1">// Remove the found message from our array</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Return the removed message</span>
    <span class="k">return</span> <span class="nx">message</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">(</span><span class="nx">feathers</span><span class="p">());</span>

<span class="c1">// Turn on JSON body parsing for REST services</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="c1">// Turn on URL-encoded body parsing for REST services</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span> <span class="nx">extended</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}));</span>
<span class="c1">// Set up REST transport using Express</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">configure</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">rest</span><span class="p">());</span>

<span class="c1">// Initialize the messages service by creating</span>
<span class="c1">// a new instance of our class</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;messages&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Messages</span><span class="p">());</span>

<span class="c1">// Set up an error handler that gives us nicer errors</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">errorHandler</span><span class="p">());</span>

<span class="c1">// Start the server on port 3030</span>
<span class="kr">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">3030</span><span class="p">);</span>

<span class="c1">// Use the service to create a new message on the server</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">service</span><span class="p">(</span><span class="s1">&#39;messages&#39;</span><span class="p">).</span><span class="nx">create</span><span class="p">({</span>
  <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;Hello from the server&#39;</span>
<span class="p">});</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;listening&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Feathers REST API started at http://localhost:3030&#39;</span><span class="p">));</span>
</pre></div>
</div>
<p>您可以通过运行来启动服务器</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>node app.js
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>服务器将一直运行, 直到您通过终端中的 Control + C 停止它.记得每次 <code class="docutils literal notranslate"><span class="pre">app.js</span></code> 改变时停止并启动服务器.</p>
</div>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>在Express中一个错误处理程序, 这里 <code class="docutils literal notranslate"><span class="pre">app.use(express.errorHandler());</span></code>, 总是必须是启动服务器之前的最后一行.</p>
</div>
</div>
<div class="section" id="using-the-api">
<h2>使用API<a class="headerlink" href="#using-the-api" title="永久链接至标题">¶</a></h2>
<p>一旦服务器运行, 我们可以做的第一件事是在浏览器中点击 <a class="reference external" href="http://localhost:3030/messages">localhost:3030/messages</a>. 由于我们已经在服务器上创建了一条消息, 因此JSON响应将如下所示:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;text&quot;</span><span class="o">:</span><span class="s2">&quot;Hello from the server&quot;</span><span class="p">}]</span>
</pre></div>
</div>
<p>我们还可以通过转到 <a class="reference external" href="http://localhost:3030/messages/1">localhost:3030/messages/1</a> 来检索该特定消息.</p>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>一个浏览器插件, 如 <a class="reference external" href="https://chrome.google.com/webstore/detail/json-viewer/gbmdgpbipfallnflgajpaliibnhdgobh">适用于Chrome的JSON查看器</a>, 可以更好地查看JSON响应.</p>
</div>
<p>现在可以通过在命令行上使用cURL将带有JSON数据的POST请求发送到同一URL来创建新消息, 如下所示:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">curl -X POST \</span>
<span class="go">  http://localhost:3030/messages/ \</span>
<span class="go">  -H &#39;Content-Type: application/json&#39; \</span>
<span class="go">  -d &#39;{ &quot;text&quot;: &quot;Hello from the command line!&quot; }&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>您还可以使用 <a class="reference external" href="https://www.getpostman.com/">Postman</a> 等工具发出HTTP请求.</p>
</div>
<p>如果您现在刷新 <a class="reference external" href="http://localhost:3030/messages">localhost:3030/messages</a>, 您将看到新创建的消息.</p>
<p>我们还可以通过向其URL发送 <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> 来删除消息:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">curl -X DELETE \</span>
<span class="go">  http://localhost:3030/messages/1</span>
</pre></div>
</div>
</div>
<div class="section" id="whats-next">
<h2>下一步是什么？<a class="headerlink" href="#whats-next" title="永久链接至标题">¶</a></h2>
<p>在本章中, 我们构建了一个功能完备的消息REST API.您可能已经可以想象我们的消息服务如何将其数据存储在数据库中而不是 <span class="xref std std-doc">messages</span> 数组中.在 <a class="reference external" href="./databases">下一章</a> 中, 让我们看看一些实现不同数据库的服务, 允许我们用更少的代码创建这些API！</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="databases.html" class="btn btn-neutral float-right" title="数据库" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="hooks.html" class="btn btn-neutral float-left" title="钩子" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, BandCap

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>